<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Gaetan DELBART">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Events - WelpBatch Bundle</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Events";
    var mkdocs_page_input_path = "event.md";
    var mkdocs_page_url = "/event/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> WelpBatch Bundle</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="..">Index</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../installation/">Installation</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../configuration/">Configuration</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../api/">API</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 current">
        <a class="current" href="./">Events</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#event">Event</a></li>
                
                    <li><a class="toctree-l4" href="#where-to-find-events">Where to find Events ?</a></li>
                
                    <li><a class="toctree-l4" href="#when-are-they-raised">When are they raised ?</a></li>
                
                    <li><a class="toctree-l4" href="#event-listener-of-our-bundle">Event Listener of our bundle</a></li>
                
                    <li><a class="toctree-l4" href="#event-entity">Event Entity</a></li>
                
                    <li><a class="toctree-l4" href="#synchronisation-with-your-application">Synchronisation with your application</a></li>
                
            
            </ul>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../explanation/">Explanation</a>
        
    </li>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">WelpBatch Bundle</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Events</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/welpdev/batchoperation-bundle/edit/master/docs/event.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="event">Event</h1>
<p>We raise 3 events during the processing of the operations.</p>
<ul>
<li>WelpBatchEvent::WELP_BATCH_OPERATION_STARTED</li>
<li>WelpBatchEvent::WELP_BATCH_OPERATION_FINISHED</li>
<li>WelpBatchEvent::WELP_BATCH_OPERATION_ERROR</li>
<li>WelpBatchEvent::WELP_BATCH_ENTITY_CREATED</li>
<li>WelpBatchEvent::WELP_BATCH_ENTITY_DELETED</li>
</ul>
<h2 id="where-to-find-events">Where to find Events ?</h2>
<p>All our events are declared in the <code>Welp\BatchBundle\WelpBatchEvent</code></p>
<h2 id="when-are-they-raised">When are they raised ?</h2>
<h3 id="welpbatcheventwelp_batch_operation_started">WelpBatchEvent::WELP_BATCH_OPERATION_STARTED</h3>
<p>This one is raised at the beginning of an operation.</p>
<h3 id="welpbatcheventwelp_batch_operation_finished">WelpBatchEvent::WELP_BATCH_OPERATION_FINISHED</h3>
<p>This one is raised at the end of an operation (even if an error is encounter in the operation)</p>
<h3 id="welpbatcheventwelp_batch_operation_error">WelpBatchEvent::WELP_BATCH_OPERATION_ERROR</h3>
<p>This one is raised when a action launch by an operation throw an error. Possible error can be :</p>
<ul>
<li>Entity not found (the id given in the payload doesn't match any id the database)</li>
<li>Form error (the payload given to be bind to the form is nor correct =&gt; Extra Fields, required field not given)</li>
</ul>
<h3 id="welpbatcheventwelp_batch_entity_created">WelpBatchEvent::WELP_BATCH_ENTITY_CREATED</h3>
<p>This one is raised when a entity is created by a consumer</p>
<h3 id="welpbatcheventwelp_batch_entity_deleted">WelpBatchEvent::WELP_BATCH_ENTITY_DELETED</h3>
<p>This one is raised when a entity is deleted by a consumer</p>
<h2 id="event-listener-of-our-bundle">Event Listener of our bundle</h2>
<p>Our event listener is here : <code>Welp\BatchBundle\EventListener\OperationListener</code></p>
<pre class="highlight"><code class="language-php linenums">return [
    WelpBatchEvent::WELP_BATCH_OPERATION_STARTED =&gt; 'startOperation',
    WelpBatchEvent::WELP_BATCH_OPERATION_FINISHED =&gt; 'finishOperation',
    WelpBatchEvent::WELP_BATCH_OPERATION_ERROR =&gt; 'errorOperation',
];</code></pre>

<h3 id="welpbatcheventwelp_batch_operation_started_1">WelpBatchEvent::WELP_BATCH_OPERATION_STARTED</h3>
<p>When this event is raised, if the batch is not started, we change the status of the batch</p>
<h3 id="welpbatcheventwelp_batch_operation_finished_1">WelpBatchEvent::WELP_BATCH_OPERATION_FINISHED</h3>
<p>When this event is raised, we update the Status of the batch. If all operations are finished, we create the file containing the results</p>
<h3 id="welpbatcheventwelp_batch_operation_error_1">WelpBatchEvent::WELP_BATCH_OPERATION_ERROR</h3>
<p>When this event is raised, we update the status of the batch, and we add an error to the errors array of the batch. This array will then be used for formatting the result file.</p>
<h2 id="event-entity">Event Entity</h2>
<p>All our event are in the namespace <code>Welp\BatchBundle\Event</code></p>
<h3 id="batchevent">BatchEvent</h3>
<p>This event contain the batch, and the operationId. It is use when the <code>WelpBatchEvent::WELP_BATCH_OPERATION_STARTED</code> and the <code>WelpBatchEvent::WELP_BATCH_OPERATION_FINISHED</code> are dispatch.</p>
<p>You can access those properties with our getters</p>
<pre class="highlight"><code class="language-php linenums">public function test(BatchEvent $event)
{
    $batch = $event-&gt;getBatch();
    $operationId = $event-&gt;getOperationId();
}</code></pre>

<h3 id="batcherrorevent">BatchErrorEvent</h3>
<p>This event contain the batch, the error and the operationId. It is use when the <code>WelpBatchEvent::WELP_BATCH_OPERATION_ERROR</code> is dispatch</p>
<p>You can access those properties with our getters</p>
<pre class="highlight"><code class="language-php linenums">public function test(BatchErrorEvent $event)
{
    $batch = $event-&gt;getBatch();
    $operationId = $event-&gt;getOperationId();
    $error = $event-&gt;getError();
}</code></pre>

<h3 id="batchentitycreatedevent">BatchEntityCreatedEvent</h3>
<p>This event contain the created entity and the className of the created entity. It is use when the <code>WelpBatchEvent::WELP_BATCH_ENTITY_CREATED</code> is dispatch</p>
<p>You can access those properties with our getters</p>
<pre class="highlight"><code class="language-php linenums">public function test(BatchEntityCreatedEvent $event)
{
    $entity = $event-&gt;getEntity();
    $className = $event-&gt;getClassName();
}</code></pre>

<h3 id="batchentitydeletedevent">BatchEntityDeletedEvent</h3>
<p>This event contain the created entity and the className of the created entity. It is use when the <code>WelpBatchEvent::WELP_BATCH_ENTITY_DELETED</code> is dispatch</p>
<p>You can access those properties with our getters</p>
<pre class="highlight"><code class="language-php linenums">public function test(BatchEntityDeletedEvent $event)
{
    $entity = $event-&gt;getEntity();
    $className = $event-&gt;getClassName();
}</code></pre>

<h2 id="synchronisation-with-your-application">Synchronisation with your application</h2>
<p>If you want to launch some custom action when a entity is created/deleted, we advise you to listen to the <code>WelpBatchEvent::WELP_BATCH_ENTITY_CREATED</code> and the <code>WelpBatchEvent::WELP_BATCH_ENTITY_DELETED</code> events.</p>
<p>You will be able to get the entity, and made custom actions on it.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../explanation/" class="btn btn-neutral float-right" title="Explanation">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../api/" class="btn btn-neutral" title="API"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>MIT</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/welpdev/batchoperation-bundle" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../api/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../explanation/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../js/theme.js"></script>

</body>
</html>
